# Wiki 起票ルール記載規約

## 概要

プロジェクトごとにチケット起票ルールが異なる場合、Redmine Wiki の **`TicketRules`** ページにルールを記載する。
コーディングエージェント（Claude Code 等）は `get_ticket_rules` ツールでこのページを取得し、ルールに従ってチケットを作成する。

## ページ名

各プロジェクトの Wiki に **`TicketRules`** というタイトルでページを作成する。

- ページが存在しない場合 → そのプロジェクトには固有の起票ルールがないと見なす
- ページが存在する場合 → 記載内容に従ってチケットを作成する

## ページ構成

以下のセクション構成で記載する。すべてのセクションは任意（不要なセクションは省略可）。

```markdown
# チケット起票ルール

## トラッカー

使用するトラッカーとその用途を記載する。

| トラッカー | tracker_id | 用途 |
|-----------|------------|------|
| バグ       | 1          | 不具合の報告 |
| 機能       | 2          | 新機能の要望 |
| タスク     | 3          | 作業タスク |

## 必須フィールド

チケット作成時に必ず設定するフィールドを列挙する。

- subject（件名）
- description（説明）
- tracker_id（トラッカー）
- priority_id（優先度）

## 件名の命名規則

件名のフォーマットを定義する。

- バグ: `[BUG] 〈現象の簡潔な説明〉`
- 機能: `[FEATURE] 〈機能名〉`
- タスク: `[TASK] 〈作業内容〉`

## 説明テンプレート

トラッカーごとの説明欄テンプレートを記載する。

### バグ報告テンプレート

~~~
## 概要
（不具合の概要を記載）

## 再現手順
1.
2.
3.

## 期待する動作
（正しい動作を記載）

## 実際の動作
（実際に起きた動作を記載）

## 環境
- OS:
- ブラウザ:
- バージョン:
~~~

### 機能要望テンプレート

~~~
## 概要
（機能の概要を記載）

## 背景・目的
（なぜこの機能が必要かを記載）

## 要件
-
-

## 受け入れ条件
-
-
~~~

## デフォルト値

明示的に指定がない場合に使用するデフォルト値を記載する。

| フィールド | デフォルト値 | 備考 |
|-----------|-------------|------|
| priority_id | 2 | 通常 |
| assigned_to_id | （なし） | 未割り当て |

## 親チケット

親チケットの運用ルールがある場合に記載する。

- 機能開発は親チケットを作成し、サブタスクに分割すること
- バグ報告は親チケット不要

## 注意事項

プロジェクト固有の注意事項を自由記述で記載する。

- 顧客向けプロジェクトの場合、件名に顧客名を含めないこと
- 見積もり工数（estimated_hours）は必ず設定すること
```

## セクション詳細

### トラッカー

プロジェクトで使用するトラッカーの一覧と、各トラッカーの用途を表形式で記載する。
`tracker_id` を明記することで、エージェントが正しいトラッカーを選択できる。

### 必須フィールド

チケット作成時に必須とするフィールド名をリスト形式で記載する。
Redmine API のフィールド名（`subject`, `description`, `tracker_id` 等）を使用する。

### 件名の命名規則

件名（subject）のフォーマットルールを記載する。
プレフィックスやパターンを定義し、エージェントが統一的な件名を生成できるようにする。

### 説明テンプレート

トラッカーごとの説明欄（description）のテンプレートを記載する。
コードブロック（`~~~` または ` ``` `）で囲んでテンプレート本文を記載する。

### デフォルト値

フィールドの省略時に使用するデフォルト値を表形式で記載する。

### 親チケット

親子チケットの運用ルールがある場合に記載する。

### 注意事項

上記セクションに収まらないプロジェクト固有のルールを自由記述で記載する。

## エージェントの利用フロー

1. チケットを作成する前に `get_ticket_rules(project_id)` を呼び出す
2. ページが存在すれば、記載されたルールに従ってチケットを作成する
3. ページが存在しなければ（404）、一般的なルールでチケットを作成する
4. 必須フィールドが不足している場合はユーザーに確認する
